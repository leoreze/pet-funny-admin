<!DOCTYPE html>
<html lang="pt-BR">
<head>
<!-- PATCH: Desativar multi-servi√ßos no agendamento (admin). 2025-12-24 -->
  <meta charset="UTF-8" />
  <title>Admin ‚Äì Pet Funny</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <link rel="stylesheet" href="style.css" />
</head>
<body>

<header class="top-brand">
  <img src="pet-funny-logo.svg" alt="Pet Funny" />
</header>

<section id="loginScreen">
  <div class="login-card">
    <div class="login-title">√Årea Administrativa ‚Äì Pet Funny</div>
    <div class="login-subtitle">
      Acesse com o usu√°rio e senha da equipe para ver agenda, clientes e pets.
    </div>

    <div class="login-field">
      <div class="login-label">Usu√°rio</div>
      <input type="text" id="loginUser" class="login-input" placeholder="adminpetfunny" />
    </div>

    <div class="login-field">
      <div class="login-label">Senha</div>
      <input type="password" id="loginPass" class="login-input" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢" />
    </div>

    <button id="btnLogin" class="btn" style="margin-top: 8px;">
      Entrar no painel
    </button>

    <div id="loginError" class="login-error hidden">
      Usu√°rio ou senha incorretos. Tente novamente.
    </div>

    <div class="login-footer-hint">
      √Årea exclusiva para a equipe Pet Funny.
    </div>
  </div>
</section>

<div id="adminApp">
  <div class="container">
<div class="header header-admin">
  <!-- Menu + texto + logo-sub (lado esquerdo) -->
  <div class="header-left">
    <button
      id="btnMenu"
      class="menu-trigger"
      type="button"
      aria-label="Abrir menu"
      aria-expanded="false"
    >
      <span class="menu-icon" aria-hidden="true">‚ò∞</span>
      <span class="menu-text">Menu</span>
    </button>

    <div class="logo-sub logo-inline">
      √Årea Administrativa ‚Äì Pet Funny
    </div>
  </div>

  <!-- A√ß√µes (lado direito) -->
  <div class="filters header-right">
    <button class="btn btn-danger btn-small" id="btnLogout" type="button">
      Sair
    </button>
  </div>
</div>



<!-- MENU LATERAL (HAMBURGUER) -->
<div id="sidebarBackdrop" class="sidebar-backdrop hidden"></div>

<nav id="sidebar" class="sidebar hidden" aria-label="Menu do painel">
  <div class="sidebar-header">
    <div class="sidebar-title">Menu</div>
    <button id="btnMenuClose" class="sidebar-close" type="button" aria-label="Fechar menu">‚úï</button>
  </div>

  <div class="sidebar-links">
    <!-- Reaproveita os MESMOS bot√µes/tab-btn e data-tab -->
    <button class="tab-btn active" data-tab="tab-agenda" type="button"><span>üìÖ</span> Agendamentos</button>
    <button class="tab-btn" data-tab="tab-clientes" type="button"><span>üë§</span> Clientes &amp; Pets</button>
    <button class="tab-btn" data-tab="tab-servicos" type="button"><span>üßº</span> Servi√ßos</button>
<button class="tab-btn" data-tab="tab-mimos" type="button"><span>üéÅ</span> Mimos</button>
    <button class="tab-btn" data-tab="tab-horarios" type="button"><span>‚è±Ô∏è</span> Hor√°rio de Funcionamento</button>
    <button class="tab-btn" data-tab="tab-dashboard" type="button"><span>üìä</span> Dashboard</button>
  <button class="tab-btn" data-tab="tab-financeiro" type="button"><span>üí∞</span> Financeiro</button>
  </div>
</nav>


    <!-- TAB: AGENDA -->
    <section id="tab-agenda" class="tab-view active">
      <div class="section-title-row">
         <div class="section-title">Agendamentos</div>

           <div class="agenda-actions-right">
          <!-- NOVO: Toggle Lista/Cards -->
          <div class="view-toggle" aria-label="Alternar visualiza√ß√£o">
            <button class="toggle-btn active" id="btnViewList" type="button">üìã Lista</button>
            <button class="toggle-btn" id="btnViewCards" type="button">üóÇÔ∏è Cards</button>
          </div>

          <button class="btn btn-light" id="btnNovoAgendamento" type="button">+ Novo agendamento</button>
        </div>
      </div>

 

        <!-- FILTROS (APENAS DA AGENDA) -->
  <div class="agenda-filters" style="margin: 8px 0 14px; display:flex; flex-wrap:wrap; gap:10px; align-items:center;">
    <div class="filters-group">
      <label style="font-size:12px;">Data</label>
      <input type="date" id="filtroData" />
    </div>

    <button class="btn btn-light" id="btnHoje" type="button">Hoje</button>
    <button class="btn btn-light" id="btnLimparFiltro" type="button">Limpar</button>

    <div class="filters-group" style="flex:1; min-width:200px;">
      <label style="font-size:12px;">Buscar</label>
      <input
        type="text"
        id="filtroBusca"
        placeholder="Nome do tutor, pet ou telefone"
        style="width:100%;"
      />
    </div>

    <button class="btn btn-light" id="btnExportarCSV" type="button">
      Exportar CSV
    </button>
  </div>

      

      <div class="form-panel hidden" id="formPanel">
        <input type="hidden" id="bookingId" />
        <input type="hidden" id="bookingOriginalStatus" />

        <div class="form-row">
          <div class="form-group">
            <label for="formPhone">Telefone (WhatsApp)</label>
            <input type="text" id="formPhone" placeholder="(16) 9 9999-9999" />
          </div>
          <div class="form-group">
            <label for="formNome">Tutor(a)</label>
            <input type="text" id="formNome" placeholder="Nome do tutor" />
          </div>
          <div class="form-group">
            <label for="formPetSelect">Pet (opcional)</label>
            <select id="formPetSelect">
              <option value="">(Sem pet informado)</option>
            </select>
          </div>
          <div class="form-group">
            <label for="formPrize">Mimo (Roleta)</label>
            <select id="formPrize">
              <option value="">‚Äî Sem mimo ‚Äî</option>
            </select>
          </div>
        </div>

        <div class="form-row-2">
          <div class="form-group">
            <label for="formService">Servi√ßos (pode adicionar mais de 1)</label>
            <div class="service-picker">
              <select id="formService">
                <option value="">Carregando servi√ßos...</option>
              </select>
              <button type="button" class="btn btn-secondary" id="btnAddService">Adicionar</button>
            </div>
            <div class="selected-services" id="selectedServicesWrap" style="display:none;">
              <div class="selected-services-title">Servi√ßos selecionados</div>
              <ul id="selectedServicesList"></ul>
              <div class="selected-services-total">Total servi√ßos: <span id="servicesTotal">R$ 0,00</span></div>
            
            <div class="service-meta-row">
              <div class="form-group">
                <label for="formServiceValue">Valor dos servi√ßos (R$)</label>
                <input type="text" id="formServiceValue" class="-field" placeholder="R$ 0,00"  / readonly>
              </div>
              <div class="form-group">
                <label for="formServiceDuration">Tempo total (min)</label>
                <input type="number" id="formServiceDuration" class="-field" placeholder="0"  / readonly>
              </div>
            </div>
</div>
          </div>
          <div class="form-group">
            <label for="formDate">Data</label>
            <input type="date" id="formDate" />
          </div>
          <div class="form-group">
            <label for="formTime">Hor√°rio</label>
            <input type="time" id="formTime" />
          </div>
        </div>

        <div class="form-row-2">
          <div class="form-group">
            <label for="formStatus">Status</label>
            <select id="formStatus">
              <option value="agendado">Agendado</option>
              <option value="confirmado">Confirmado</option>
              <option value="recebido">Recebido</option>
              <option value="em servi√ßo">Em servi√ßo</option>
              <option value="conclu√≠do">Conclu√≠do</option>
              <option value="entregue">Entregue</option>
              <option value="cancelado">Cancelado</option>
            </select>
          </div>

          <div class="form-group">
            <label for="formPaymentStatus">Pagamento</label>
            <select id="formPaymentStatus">
              <option value="N√£o Pago">N√£o Pago</option>
              <option value="Pago">Pago</option>
            </select>
          </div>

          <div class="form-group">
            <label for="formPaymentMethod">Forma de Pagamento</label>
            <select id="formPaymentMethod">
              <option value="">‚Äî Selecione ‚Äî</option>
              <option value="Dinheiro">Dinheiro</option>
              <option value="D√©bito">D√©bito</option>
              <option value="Cr√©dito">Cr√©dito</option>
              <option value="Pix">Pix</option>
            </select>
          </div>
        </div>

        <div class="form-group">
          <label for="formNotes">Observa√ß√µes</label>
          <textarea id="formNotes" placeholder="Ex: porte, comportamento, cuidados especiais..."></textarea>
        </div>

        <div id="formError" class="error-msg" style="display:none;"></div>

        <div class="form-actions">
          <button class="btn btn-secondary" id="btnCancelarEdicao" type="button">Limpar / cancelar</button>
          <button class="btn" id="btnSalvar" type="button">Salvar</button>
        </div>
      </div>

      <div class="stats">
        <div class="stats-item"><span class="stats-label">Total de agendamentos:</span> <span class="stats-value" id="statTotal">0</span></div>
        <div class="stats-item"><span class="stats-label">Tosa Higi√™nica:</span> <span class="stats-value" id="statTosa">0</span></div>
        <div class="stats-item"><span class="stats-label">Hidrata√ß√£o:</span> <span class="stats-value" id="statHidratacao">0</span></div>
        <div class="stats-item"><span class="stats-label">Foto/V√≠deo:</span> <span class="stats-value" id="statFotoVideo">0</span></div>
        <div class="stats-item"><span class="stats-label">Patinhas impec√°veis:</span> <span class="stats-value" id="statPatinhas">0</span></div>
<div id="statMimosList" class="stats-mimos-list">‚Äî</div>
      </div>

       <!-- NOVO: Wrapper Lista -->
      <div id="agendaListWrapper" class="table-wrapper">
        <table>
          <thead>
          <tr>
            <th>Data</th>
            <th>Hora</th>
            <th>Tutor(a)</th>
            <th>Pet</th>
            <th>Telefone</th>
            <th>Servi√ßo(s)</th>
            <th>Valores e tempo(s)</th>
            <th>Mimo</th>
            <th>Status</th>
            <th>Pagamento</th>
            <th>Forma de Pagamento</th>
            <th>√öltima notifica√ß√£o</th>
            <th>Obs.</th>
            <th>A√ß√µes</th>
          </tr>
          </thead>
          <tbody id="tbodyAgenda"></tbody>
        </table>
        <div id="estadoVazio" class="empty" style="display:none;">Nenhum agendamento encontrado para o filtro atual.</div>
      </div>

      <!-- NOVO: Wrapper Cards -->
      <div id="agendaCardsWrapper" class="cards-wrapper hidden">
        <div id="agendaCards" class="cards-grid"></div>
        <div id="estadoVazioCards" class="empty hidden">Nenhum agendamento encontrado para o filtro atual.</div>
      </div>
      
</div>

     
    </section>

    <!-- TAB: CLIENTES & PETS -->
    <section id="tab-clientes" class="tab-view">
      <div class="section-title">Clientes &amp; Pets</div>
      <div class="tab-toolbar">
        <div class="filters-group">
          <span style="font-size:13px;">Buscar:</span>
          <input type="text" id="filtroClientes" placeholder="Nome do tutor ou telefone" />
          <button class="btn btn-light" id="btnLimparClientes" type="button">Limpar</button>
        </div>
      </div>
      <div class="two-cols">
        <!-- CLIENTES -->
        <div class="subcard">
          <div class="subcard-title">
            <span>Clientes</span>
            <span id="badgeClienteSelecionado" class="badge-mini badge-selected hidden">Cliente selecionado</span>
            <button class="btn btn-secondary btn-small" id="btnNovoCliente" type="button">+ Novo cliente</button>
          </div>

          <div id="clienteFormBlock" class="hidden">
            <div class="form-group">
              <label for="cliPhone">Telefone (WhatsApp)</label>
              <input type="text" id="cliPhone" placeholder="(16) 9 9999-9999" />
            </div>
            <div class="form-group">
              <label for="cliName">Nome do tutor</label>
              <input type="text" id="cliName" placeholder="Nome completo" />
            </div>
        <!-- PATCH: add customer address fields (CEP, rua, etc) - 2025-12-24 -->
        <div class="form-group">
          <label for="cliCep">CEP</label>
          <input type="text" id="cliCep" placeholder="00000-000" autocomplete="postal-code">
        </div>
        <div class="form-group">
          <label for="cliStreet">Logradouro</label>
          <input type="text" id="cliStreet" placeholder="Rua / Avenida" autocomplete="address-line1">
        </div>
        <div class="form-group">
          <label for="cliNumber">N√∫mero</label>
          <input type="text" id="cliNumber" placeholder="N√∫mero" autocomplete="address-line2">
        </div>
        <div class="form-group">
          <label for="cliComplement">Complemento</label>
          <input type="text" id="cliComplement" placeholder="Apto, Bloco, etc">
        </div>
        <div class="form-group">
          <label for="cliNeighborhood">Bairro</label>
          <input type="text" id="cliNeighborhood" placeholder="Bairro">
        </div>
        <div class="form-group">
          <label for="cliCity">Cidade</label>
          <input type="text" id="cliCity" placeholder="Cidade">
        </div>
        <div class="form-group">
          <label for="cliState">UF</label>
          <input type="text" id="cliState" placeholder="UF" maxlength="2" style="text-transform:uppercase">
        </div>

            <div id="cliError" class="error-msg" style="display:none;"></div>
            <div class="form-actions">
              <button class="btn btn-secondary btn-small" id="btnCliLimpar" type="button">Limpar</button>
              <button class="btn btn-small" id="btnCliSalvar" type="button">Salvar / Atualizar</button>
            </div>
          </div>

          <div class="subtable-wrapper" style="margin-top:10px;">
            <table>
              <thead>
              <tr>
                <th>ID</th>
                <th>Tutor</th>
                <th>Telefone</th>
                <th>Pets</th>
                <th>A√ß√µes</th>
              </tr>
              </thead>
              <tbody id="tbodyClientes"></tbody>
            </table>
          </div>
        </div>

        <!-- PETS DO CLIENTE SELECIONADO -->
        <div class="subcard hidden" id="petsCard">
          <div class="subcard-title">
            <span>Pets do cliente selecionado</span>
            <button class="btn btn-secondary btn-small" id="btnNovoPet" type="button">+ Novo pet</button>
          </div>
          <div class="form-group">
            <label for="petName">Nome do pet</label>
            <input type="text" id="petName" placeholder="Nome do pet" />
          </div>
          <div class="form-group">
            <label for="petBreed">Ra√ßa</label>
            <select id="petBreed"></select>
          </div>
          <div class="form-group">
            <label for="petSize">Porte</label>
            <select id="petSize">
              <option value="">(Selecione)</option>
              <option value="Pequeno">Pequeno</option>
              <option value="M√©dio">M√©dio</option>
              <option value="Grande">Grande</option>
            </select>
          </div>
          <div class="form-group">
            <label for="petCoat">Pelagem</label>
            <select id="petCoat">
              <option value="">(Selecione)</option>
              <option value="Curta">Curta</option>
              <option value="M√©dia">M√©dia</option>
              <option value="Longa">Longa</option>
            </select>
          </div>
          <div class="form-group">
            <label for="petInfo">Observa√ß√µes</label>
            <textarea id="petInfo" placeholder="Comportamento, medica√ß√£o, observa√ß√µes, etc."></textarea>
          </div>
          <div id="petError" class="error-msg" style="display:none;"></div>
          <div class="form-actions">
            <button class="btn btn-secondary btn-small" id="btnPetLimpar" type="button">Limpar</button>
            <button class="btn btn-small" id="btnPetSalvar" type="button">Salvar pet</button>
          </div>

          <div class="subtable-wrapper" style="margin-top:10px;">
            <table>
              <thead>
              <tr>
                <th>ID</th>
                <th>Nome</th>
                <th>Ra√ßa</th>
                <th>Porte</th>
                <th>Pelagem</th>
                <th>Observa√ß√µes</th>
                <th>A√ß√µes</th>
              </tr>
              </thead>
              <tbody id="tbodyPets"></tbody>
            </table>
          </div>
        </div>
      </div>
    </section>

    <!-- TAB: SERVI√áOS -->
    <section id="tab-servicos" class="tab-view">
      <div class="section-title-row">
        <div class="section-title">Servi√ßos</div>
        <div class="tab-toolbar-inline">
          <div class="filters-group">
            <span style="font-size:13px;">Buscar:</span>
            <input type="text" id="filtroServicos" placeholder="T√≠tulo do servi√ßo" />
            
            <select id="filtroCategoriaServicos" class="select-small" aria-label="Filtrar por categoria">
              <option value="">Todas categorias</option>
              <option value="Banho">Banho</option>
              <option value="Complemento">Complemento</option>
              <option value="Tosa">Tosa</option>
              <option value="Avulso">Avulso</option>
            </select>
<button class="btn btn-light" id="btnLimparServicos" type="button">Limpar</button>
          </div>
        </div>
        <button class="btn btn-light" id="btnNovoServico" type="button">+ Novo servi√ßo</button>
      </div>

      <div class="form-panel hidden" id="serviceFormPanel">
        <input type="hidden" id="serviceId" />
        <input type="hidden" id="serviceDate" />
        <div class="form-row-2">
<div class="form-group">
            <label for="serviceCategory">Categoria</label>
            <select id="serviceCategory">
              <option value="">Selecione...</option>
              <option value="Banho">Banho</option>
              <option value="Complemento">Complemento</option>
              <option value="Tosa">Tosa</option>
              <option value="Avulso">Avulso</option>
            </select>
          </div>

          <div class="form-group">
            <label for="serviceTitle">T√≠tulo do servi√ßo</label>
            <input type="text" id="serviceTitle" placeholder="Ex: Banho (Porte M)" />
          </div>

          <div class="form-group">
            <label for="servicePorte">Porte</label>
            <select id="servicePorte">
              <option value="">Selecione...</option>
              <option value="Pequeno">Pequeno</option>
              <option value="M√©dio">M√©dio</option>
              <option value="Grande">Grande</option>
            </select>
          </div>

          <div class="form-group">
            <label for="servicePrice">Pre√ßo (R$)</label>
            <input type="text" id="servicePrice" placeholder="R$ 0,00" inputmode="numeric" />
          </div>

          <div class="form-group">
            <label for="serviceTempo">Tempo (min)</label>
            <input type="number" name="duration_min" id="serviceTempo" class="input-tempo-min" min="0" step="5" placeholder="Ex: 60" inputmode="numeric" />
          </div>
        </div>

        <div id="serviceError" class="error-msg" style="display:none;"></div>

        <div class="form-actions">
          <button class="btn btn-secondary" id="btnServiceCancel" type="button">Limpar / cancelar</button>
          <button class="btn" id="btnServiceSave" type="button">Salvar</button>
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>ID</th>
              <th>Data</th>
              <th>Categoria</th>
              <th>T√≠tulo</th>
              <th>Porte</th>
              <th>Tempo</th>
              <th>Valor</th>
              <th>Criado em</th>
              <th>Atualizado em</th>
              <th>A√ß√µes</th>
            </tr>
          </thead>
          <tbody id="tbodyServices"></tbody>
        </table>
        <div id="servicesEmpty" class="empty" style="display:none;">Nenhum servi√ßo cadastrado ainda.</div>
      </div>
    </section>

    
    <!-- TAB: RA√áAS DE C√ÉES -->
<!-- TAB: MIMOS -->
<section id="tab-mimos" class="tab-view">
  <div class="section-title-row">
    <div class="section-title">Mimos</div>

    <div class="section-actions" style="display:flex; gap:10px; align-items:center; flex-wrap:wrap;">
      <div style="display:flex; gap:8px; align-items:center;">
        <input id="mimosSearch" type="text" placeholder="Buscar mimos..." class="input" style="min-width:260px;" />
      </div>

      <button class="btn" id="btnNovoMimo" type="button">Novo Mimo</button>
      <button class="btn btn-secondary btn-small" id="btnMimosReload" type="button">Recarregar</button>
    </div>
  </div>

  <div class="card">

    <!-- Form colaps√°vel (fechado por padr√£o) -->
    <div id="mimoFormWrap" class="card" style="margin:0 0 16px 0; display:none;">
      <div style="display:flex; align-items:center; justify-content:space-between; gap:10px;">
        <h3 style="margin:0;">Cadastrar / Editar Mimo</h3>
        <button class="btn btn-secondary btn-small" id="btnFecharMimoForm" type="button">Fechar</button>
      </div>

      <div class="grid-2" style="margin-top:12px;">
        <div>
          <div class="form-row">
            <label for="mimoTitle">T√≠tulo</label>
            <input id="mimoTitle" type="text" placeholder="Ex.: üéÅ Banho Gr√°tis" maxlength="80" />
          </div>

          <div class="form-row">
            <label for="mimoDesc">Descri√ß√£o (com emojis)</label>
            <textarea id="mimoDesc" rows="3" placeholder="Ex.: üéâ Voc√™ ganhou 1 banho gr√°tis!"></textarea>

            <div id="emojiPanel" style="margin-top:10px; display:flex; flex-wrap:wrap; gap:6px; user-select:none;"></div>
            <small style="opacity:.75">Dica r√°pida: no Windows, use <b>Win + .</b> para abrir o seletor de emojis.</small>
          </div>
        </div>

        <div>
          <div class="grid-2">
            <div class="form-row">
              <label for="mimoValue">Valor (R$)</label>
              <input id="mimoValue" type="text" inputmode="numeric" placeholder="0,00" />
            </div>

            <div class="form-row" style="display:flex; align-items:flex-end;">
              <label style="display:flex; gap:8px; align-items:center; margin:0;">
                <input id="mimoActive" type="checkbox" checked />
                Ativo
              </label>
            </div>
          </div>

          <div class="grid-2">
            <div class="form-row">
              <label for="mimoStart">In√≠cio</label>
              <input id="mimoStart" type="datetime-local" class="dt-input" />
            </div>

            <div class="form-row">
              <label for="mimoEnd">T√©rmino</label>
              <input id="mimoEnd" type="datetime-local" class="dt-input" />
            </div>
          </div>

          <div style="display:flex; gap:8px; margin-top:10px; align-items:center;">
            <button class="btn" id="btnMimoSave" type="button">Salvar</button>
            <button class="btn btn-secondary" id="btnMimoClear" type="button">Limpar</button>
            <div id="mimoMsg" style="margin-left:auto; opacity:.85;"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Lista -->
    <div style="display:flex; align-items:center; justify-content:space-between; gap:10px; margin:18px 0 14px 0;">
      <h3 style="margin:0;">Lista de Mimos</h3>
    </div>

    <div class="table-wrap">
      <table>
        <thead>
          <tr>
            <th>T√≠tulo</th>
            <th>Valor</th>
            <th>Per√≠odo</th>
            <th>Ativo</th>
            <th style="width:160px;">A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="tbodyMimos"></tbody>
      </table>
      <div id="mimosEmpty" class="empty" style="display:none;">Nenhum mimo cadastrado.</div>
    </div>

  </div>
</section>



    <!-- TAB: HOR√ÅRIO DE FUNCIONAMENTO -->
    <section id="tab-horarios" class="tab-view">
      <div class="section-title-row">
        <div class="section-title">Hor√°rio de Funcionamento</div>
        <button class="btn btn-light" id="btnHoursReload" type="button">Recarregar</button>
      </div>

      <div class="form-panel" style="margin-top:6px;">
        <div style="font-size:12px;color:#546e7a;line-height:1.35;">
          Configure por dia: abertura, fechamento, dia fechado e a capacidade m√°xima de agendamentos por <strong>slot de 30 minutos</strong>.
        </div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Dia</th>
              <th>Fechado</th>
              <th>Abertura</th>
              <th>Fechamento</th>
              <th>Capacidade por hor√°rio</th>
              <th>Atualizado em</th>
            </tr>
          </thead>
          <tbody id="tbodyHours"></tbody>
        </table>
        <div id="hoursEmpty" class="empty" style="display:none;">N√£o foi poss√≠vel carregar o hor√°rio de funcionamento.</div>
      </div>

      <div class="form-actions" style="margin-top:10px;">
        <button class="btn btn-secondary" id="btnHoursResetDefault" type="button">Restaurar padr√£o</button>
        <button class="btn" id="btnHoursSave" type="button">Salvar Hor√°rios</button>
      </div>

      <div id="hoursMsg" class="login-footer-hint" style="margin-top:8px;"></div>
    </section>


<!-- TAB: FINANCEIRO -->
<section id="tab-financeiro" class="tab-view">
  <div class="section-title-row">
    <div class="section-title">Financeiro</div>
  </div>

  <div style="display:flex; gap:8px; flex-wrap:wrap; margin-bottom:12px;">
    <button class="btn btn-small btn-secondary" type="button" onclick="loadFinanceSummary()">Resumo</button>
    <button class="btn btn-small btn-secondary" type="button" onclick="loadFinanceCashflow()">Caixa</button>
    <button class="btn btn-small btn-secondary" type="button" onclick="loadFinanceReports()">Relat√≥rios</button>
  </div>

  <div id="financeContent"></div>
</section>


<!-- TAB: DASHBOARD -->
    <section id="tab-dashboard" class="tab-view">
      <div class="section-title-row">
        <div class="section-title">Dashboard de Indicadores</div>
      </div>

      <div class="form-panel" id="dashboardFilters">
        <div class="form-row-2">
          <div class="form-group">
            <label for="dashPeriod">Per√≠odo</label>
            <select id="dashPeriod">
              <option value="today">Hoje</option>
              <option value="7">√öltimos 7 dias</option>
              <option value="30">√öltimos 30 dias</option>
              <option value="month">M√™s atual</option>
              <option value="custom">Personalizado</option>
            </select>
          </div>
          <div class="form-group dash-custom-range hidden" id="dashCustomRange">
            <label>Per√≠odo personalizado</label>
            <div style="display:flex;gap:6px;flex-wrap:wrap;">
              <input type="date" id="dashStart" />
              <input type="date" id="dashEnd" />
              <button class="btn btn-small" id="dashApply" type="button">Aplicar</button>
            </div>
          </div>
        </div>
      </div>

      <div class="stats">
        <div class="stats-item"><span class="stats-label">Agendamentos no per√≠odo:</span> <span class="stats-value" id="dashTotalBookings">0</span></div>
        <div class="stats-item"><span class="stats-label">Clientes √∫nicos no per√≠odo:</span> <span class="stats-value" id="dashUniqueCustomers">0</span></div>
        <div class="stats-item"><span class="stats-label">Total de clientes cadastrados:</span> <span class="stats-value" id="dashTotalCustomers">0</span></div>
      </div>

      <div class="section-title" style="margin-top:12px;">Status dos agendamentos</div>
      <div class="stats">
        <div class="stats-item"><span class="stats-label">Agendado:</span> <span class="stats-value" id="dashStatusAgendado">0</span></div>
        <div class="stats-item"><span class="stats-label">Confirmado:</span> <span class="stats-value" id="dashStatusConfirmado">0</span></div>
        <div class="stats-item"><span class="stats-label">Recebido:</span> <span class="stats-value" id="dashStatusRecebido">0</span></div>
        <div class="stats-item"><span class="stats-label">Em servi√ßo:</span> <span class="stats-value" id="dashStatusEmServico">0</span></div>
        <div class="stats-item"><span class="stats-label">Conclu√≠do:</span> <span class="stats-value" id="dashStatusConcluido">0</span></div>
        <div class="stats-item"><span class="stats-label">Entregue:</span> <span class="stats-value" id="dashStatusEntregue">0</span></div>
        <div class="stats-item"><span class="stats-label">Cancelado:</span> <span class="stats-value" id="dashStatusCancelado">0</span></div>
      </div>

      <div class="section-title" style="margin-top:12px;">Mimos da Roleta no per√≠odo</div>
      <div class="stats">
        <div class="stats-item"><span class="stats-label">Tosa Higi√™nica:</span> <span class="stats-value" id="dashPrizeTosa">0</span></div>
        <div class="stats-item"><span class="stats-label">Hidrata√ß√£o:</span> <span class="stats-value" id="dashPrizeHidratacao">0</span></div>
        <div class="stats-item"><span class="stats-label">Foto/V√≠deo Profissional:</span> <span class="stats-value" id="dashPrizeFotoVideo">0</span></div>
        <div class="stats-item"><span class="stats-label">Patinhas impec√°veis:</span> <span class="stats-value" id="dashPrizePatinhas">0</span></div>
      </div>

      <!-- NOVO: M√âTRICAS FINANCEIRAS POR SERVI√áO -->
      <div class="section-title" style="margin-top:16px;">Servi√ßos no per√≠odo (quantidade e faturamento estimado)</div>

      <div class="stats">
        <div class="stats-item"><span class="stats-label">Faturamento estimado no per√≠odo:</span> <span class="stats-value" id="dashRevenue">R$ 0,00</span></div>
        <div class="stats-item"><span class="stats-label">Ticket m√©dio estimado:</span> <span class="stats-value" id="dashAvgTicket">R$ 0,00</span></div>
      </div>

      <div class="table-wrapper">
        <table>
          <thead>
            <tr>
              <th>Servi√ßo</th>
              <th>Qtd.</th>
              <th>Pre√ßo (cadastro)</th>
              <th>Total</th>
            </tr>
          </thead>
          <tbody id="tbodyDashServices"></tbody>
        </table>
        <div id="dashServicesEmpty" class="empty" style="display:none;">Sem dados suficientes para compor o financeiro por servi√ßo.</div>
      </div>

      <div class="section-title" style="margin-top:20px;">Vis√£o Gr√°fica</div>
      <div style="display:flex;flex-wrap:wrap;gap:20px;justify-content:center;margin-top:10px;">
        <div style="background:#fff;border-radius:16px;padding:12px;box-shadow:0 4px 14px rgba(0,0,0,0.06);">
          <canvas id="chartStatus" style="max-width:460px;"></canvas>
        </div>
        <div style="background:#fff;border-radius:16px;padding:12px;box-shadow:0 4px 14px rgba(0,0,0,0.06);">
          <canvas id="chartPrizes" style="max-width:380px;"></canvas>
        </div>
      </div>
    </section>

    <div class="footer">
      <div>Dados via API (<code>/api/customers</code>, <code>/api/pets</code>, <code>/api/bookings</code>, <code>/api/services</code>). Exporta√ß√£o CSV feita no navegador.</div>
      <div>Pet Funny ‚Ä¢ Admin CRUD &amp; Status</div>
    </div>
  </div>
</div>

<footer class="site-footer">
  <div class="footer-inner">
    <div class="footer-top">
      <img src="pet-funny-logo.svg" alt="Pet Funny" class="footer-logo" />
      <div class="footer-info">
        <strong>Pet Funny ‚Ä¢ Banho &amp; Tosa</strong>
        <span>Rua Virg√≠lio de Carvalho Neves Neto, 794 ‚Äì Ribeir√£o Preto / SP</span>
        <span>Hor√°rio: Seg‚ÄìSex: 07:30 √†s 17:30 ‚Ä¢ S√°bado: 07:30 √†s 13:00</span>
        <span>WhatsApp: (16) 98153-5338</span>
      </div>
    </div>
    <div class="footer-bottom">¬© 2024 Pet Funny ‚Ä¢ Roleta de Mimos. Todos os direitos reservados.</div>
  </div>
</footer>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<!-- PATCH: load modular JS in correct order (globals for backward compatibility) - 2025-12-24 -->
<script src="pf_time.js"></script>
<script src="pf_helpers.js"></script>
<script src="pf_api.js"></script>
<script src="scripts.js"></script>
<!-- <script src="pf_healthcheck.js"></script> -->
<!-- PF HINT MODAL (auto-close + focus) -->
<div id="pfHintOverlay" class="pf-hint-overlay" aria-hidden="true">
  <div class="pf-hint-modal" role="dialog" aria-modal="true" aria-label="Notifica√ß√£o">
    <div class="pf-hint-head">
      <div class="pf-hint-left">
        <div class="pf-hint-ic" aria-hidden="true">i</div>
        <div>
          <p class="pf-hint-title" id="pfHintTitle">Aviso</p>
          <p class="pf-hint-msg" id="pfHintMsg">...</p>
        </div>
      </div>
      <button class="pf-hint-x" id="pfHintClose" type="button" aria-label="Fechar">√ó</button>
    </div>
    <div class="pf-hint-bar" aria-hidden="true"><i id="pfHintBar"></i></div>
  </div>
</div>

</body>
</html>